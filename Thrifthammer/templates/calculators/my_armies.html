{% extends "base.html" %}

{% block title %}My Army Lists{% endblock %}

{% block content %}
<div class="page-content">

  <div style="display:flex;align-items:flex-end;justify-content:space-between;flex-wrap:wrap;gap:var(--sp-4);margin-bottom:var(--sp-2);">
    <div>
      <h1 class="section-title">My Army Lists</h1>
      <div class="gold-rule"></div>
    </div>
    <a href="{% url 'calculators:space_marines' %}" class="btn btn-primary">Build New List</a>
  </div>

  {% if armies %}
  <div style="display:flex;flex-direction:column;gap:var(--sp-3);">
    {% for army in armies %}
    <div class="card" style="padding:var(--sp-4) var(--sp-5);">
      <div style="display:flex;align-items:center;justify-content:space-between;flex-wrap:wrap;gap:var(--sp-4);">

        <div>
          <h3 style="font-size:1rem;margin-bottom:var(--sp-2);">
            <a href="{{ army.get_absolute_url }}" style="color:var(--text-primary);">{{ army.name }}</a>
            {% if army.is_public %}
            <span class="badge badge-green" style="margin-left:var(--sp-2);">Public</span>
            {% endif %}
          </h3>
          <p style="font-size:0.82rem;color:var(--text-muted);">
            <span style="color:var(--accent-gold-lt);font-family:'Oswald',sans-serif;font-weight:600;">{{ army.points_total }}</span> pts
            &nbsp;·&nbsp; Best price: <span style="color:var(--accent-green-lt);font-weight:600;">${{ army.total_cost }}</span>
            &nbsp;·&nbsp; Saves: <span style="color:var(--accent-green-lt);">${{ army.total_savings }}</span> vs MSRP
            &nbsp;·&nbsp; Saved {{ army.created_at|date:"d M Y" }}
          </p>
        </div>

        <a href="{{ army.get_absolute_url }}" class="btn btn-secondary btn-sm">View List</a>
      </div>
    </div>
    {% endfor %}
  </div>

  {% if is_paginated %}
  <nav class="pagination" aria-label="Page navigation">
    {% if page_obj.has_previous %}
    <a href="?page={{ page_obj.previous_page_number }}">&laquo; Prev</a>
    {% endif %}
    <span class="current">{{ page_obj.number }} / {{ paginator.num_pages }}</span>
    {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}">Next &raquo;</a>
    {% endif %}
  </nav>
  {% endif %}

  {% else %}
  <div style="text-align:center;padding:var(--sp-16) 0;color:var(--text-muted);">
    <div style="font-family:'Cinzel',serif;font-size:2.5rem;font-weight:900;color:var(--border-mid);margin-bottom:var(--sp-4);" aria-hidden="true">TH</div>
    <p style="font-size:1rem;margin-bottom:var(--sp-6);">
      You haven't saved any army lists yet.
    </p>
    <a href="{% url 'calculators:space_marines' %}" class="btn btn-primary">Build Your First List</a>
  </div>
  {% endif %}

</div>
{% endblock %}
